<div>
    <p>
        Generated by <a href="https://wyam.io">Wyam</a> on @DateTime.Now.ToString("R")

        @{
            var userProvidedInputPath = Context.FileSystem.RootPath.Combine(Context.FileSystem.InputPaths.Last().Combine("..\\build\\temp"));

            var commit = string.Empty;
            var vcsInfo = System.IO.Path.Combine(System.IO.Path.GetFullPath(new System.Uri(userProvidedInputPath.ToString()).LocalPath), "vcs.info.json");
            if (System.IO.File.Exists(vcsInfo))
            {
                var prefix = "\"revision\": \"";
                var lines = System.IO.File.ReadAllLines(vcsInfo);
                foreach(var line in lines)
                {
                    if (line.Contains(prefix))
                    {
                        commit = line.TrimEnd(',').TrimEnd('\"').Substring(line.IndexOf(prefix) + prefix.Length);
                    }
                }
            }

            var version = string.Empty;
            var versionInfo = System.IO.Path.Combine(System.IO.Path.GetFullPath(new System.Uri(userProvidedInputPath.ToString()).LocalPath), "semantic_version.json");
            if (System.IO.File.Exists(versionInfo))
            {
                var prefix = "\"SemVer\": \"";
                var lines = System.IO.File.ReadAllLines(versionInfo);
                foreach(var line in lines)
                {
                    if (line.Contains(prefix))
                    {
                        version = line.TrimEnd(',').TrimEnd('\"').Substring(line.IndexOf(prefix) + prefix.Length);
                    }
                }
            }

            if (!string.IsNullOrWhiteSpace(commit))
            {
                <text> from commit <a href="https://github.com/calvinverse/calvinverse.docs/tree/@commit">@commit</a> </text>
            }

            if (!string.IsNullOrWhiteSpace(version))
            {
                <text>at version @version.</text>
            }
        }
    </p>
</div>